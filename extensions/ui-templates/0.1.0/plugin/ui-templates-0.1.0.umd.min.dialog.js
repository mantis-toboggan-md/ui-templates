(("undefined"!==typeof self?self:this)["webpackChunkui_templates_0_1_0"]=("undefined"!==typeof self?self:this)["webpackChunkui_templates_0_1_0"]||[]).push([[907],{1970:function(e,a,t){var n=t(42423);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var l=t(74825).A;l("398405c0",n,!0,{sourceMap:!1,shadowMode:!1})},42423:function(e,a,t){"use strict";t.r(a);var n=t(40429),l=t.n(n),o=t(1214),s=t.n(o),r=s()(l());r.push([e.id,".create-template-container{&.card-container{box-shadow:none;border:none!important}:deep() .card-actions{display:flex;justify-content:center}}",""]),a["default"]=r},48760:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return F}});var n=t(9274);const l={class:"row mb-20"},o={class:"col span-12"},s={class:"row mb-20"},r={class:"col span-12"};function c(e,a,t,c,i,d){const p=(0,n.resolveComponent)("Banner"),m=(0,n.resolveComponent)("NameNsDescription"),u=(0,n.resolveComponent)("AsyncButton"),h=(0,n.resolveComponent)("Card");return i.model?((0,n.openBlock)(),(0,n.createBlock)(h,{key:0,class:"create-template-container"},{title:(0,n.withCtx)(()=>a[1]||(a[1]=[(0,n.createElementVNode)("h4",null,"Create a new Template",-1)])),body:(0,n.withCtx)(()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.errors,(e,a)=>((0,n.openBlock)(),(0,n.createBlock)(p,{key:a,color:"error"},{default:(0,n.withCtx)(()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e),1)]),_:2},1024))),128)),(0,n.createElementVNode)("div",l,[(0,n.createElementVNode)("div",o,[(0,n.createVNode)(m,{value:i.model,"namespace-options":i.namespaceOverride,mode:"create"},null,8,["value","namespace-options"])])])]),actions:(0,n.withCtx)(()=>[(0,n.createElementVNode)("div",s,[(0,n.createElementVNode)("div",r,[(0,n.createElementVNode)("button",{class:"btn role-secondary mr-10",onClick:a[0]||(a[0]=(...e)=>d.close&&d.close(...e))}," Cancel "),(0,n.createVNode)(u,{onClick:d.save},{default:(0,n.withCtx)(()=>a[2]||(a[2]=[(0,n.createTextVNode)(" Save Template ",-1)])),_:1,__:[2]},8,["onClick"])])])]),_:1})):(0,n.createCommentVNode)("",!0)}const i={class:"row mb-20"},d=["data-testid"],p=["aria-label"],m={class:"icon icon-close align-value"},u=["data-testid"],h=["data-testid"],v=["data-testid"],f={key:3,class:"spacer"};function y(e,a,t,l,o,s){const r=(0,n.resolveComponent)("LabeledInput"),c=(0,n.resolveComponent)("LabeledSelect"),y=(0,n.resolveDirective)("clean-tooltip");return(0,n.openBlock)(),(0,n.createElementBlock)("div",i,[(0,n.renderSlot)(e.$slots,"project-selector",{},void 0,!0),t.namespaced&&!t.nameNsHidden&&o.createNamespace?((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:0,"data-testid":t.componentTestid+"-namespace-create",class:"col span-3"},[(0,n.createVNode)(r,{ref:"namespaceInput",value:l.namespace,"onUpdate:value":a[0]||(a[0]=e=>l.namespace=e),label:e.t("namespace.label"),placeholder:e.t("namespace.createNamespace"),disabled:s.namespaceReallyDisabled,mode:t.mode,"min-height":30,required:t.nameRequired,rules:t.rules.namespace},null,8,["value","label","placeholder","disabled","mode","required","rules"]),(0,n.createElementVNode)("button",{"aria-label":e.t("namespace.cancelCreateAriaLabel"),onClick:a[1]||(a[1]=(...e)=>s.cancelCreateNamespace&&s.cancelCreateNamespace(...e))},[(0,n.withDirectives)((0,n.createElementVNode)("i",m,null,512),[[y,e.t("generic.cancel")]])],8,p)],8,d)):(0,n.createCommentVNode)("",!0),!t.namespaced||t.nameNsHidden||o.createNamespace?(0,n.createCommentVNode)("",!0):((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:1,"data-testid":t.componentTestid+"-namespace",class:"col span-3"},[(0,n.withDirectives)((0,n.createVNode)(c,{value:l.namespace,"onUpdate:value":a[2]||(a[2]=e=>l.namespace=e),clearable:!0,options:l.options,disabled:s.namespaceReallyDisabled,searchable:!0,mode:t.mode,multiple:!1,label:e.t("namespace.label"),placeholder:e.t("namespace.selectOrCreate"),rules:t.rules.namespace,required:"",onSelecting:s.selectNamespace},null,8,["value","options","disabled","mode","label","placeholder","rules","onSelecting"]),[[n.vShow,!o.createNamespace]])],8,u)),t.nameHidden||t.nameNsHidden?(0,n.createCommentVNode)("",!0):((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:2,"data-testid":t.componentTestid+"-name",class:"col span-3"},[(0,n.createVNode)(r,{ref:"nameInput",key:"name",value:l.name,"onUpdate:value":a[3]||(a[3]=e=>l.name=e),"data-testid":"NameNsDescriptionNameInput",label:e.t(t.nameLabel),placeholder:e.t(t.namePlaceholder),disabled:s.nameReallyDisabled,mode:t.mode,"min-height":30,required:t.nameRequired,rules:t.rules.name},null,8,["value","label","placeholder","disabled","mode","required","rules"])],8,h)),(0,n.renderSlot)(e.$slots,"customize",{},void 0,!0),(0,n.withDirectives)((0,n.createElementVNode)("div",{"data-testid":t.componentTestid+"-description",class:(0,n.normalizeClass)(["col",t.extraColumns.length>0?"span-3":"span-6"])},[(0,n.createVNode)(r,{key:"description",value:l.description,"onUpdate:value":a[4]||(a[4]=e=>l.description=e),mode:t.mode,disabled:t.descriptionDisabled,label:e.t(t.descriptionLabel),placeholder:e.t(t.descriptionPlaceholder),"min-height":30,rules:t.rules.description},null,8,["value","mode","disabled","label","placeholder","rules"])],10,v),[[n.vShow,!t.descriptionHidden]]),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(t.extraColumns,(a,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:t,class:(0,n.normalizeClass)({col:!0,[s.colSpan]:!0})},[(0,n.renderSlot)(e.$slots,a,{},void 0,!0)],2))),128)),t.showSpacer?((0,n.openBlock)(),(0,n.createElementBlock)("div",f)):(0,n.createCommentVNode)("",!0)])}var b=t(65359),N=t(76978),g=t(74302),w=t(35664),C=t(2841),k=t(14220),x=t(79380),B=t(58946);function S(e){return(e||"").trim().toLowerCase().replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}var D=t(95457),V={name:"NameNsDescription",emits:["update:value","isNamespaceNew"],components:{LabeledInput:x.o,LabeledSelect:B.A},props:{value:{type:Object,required:!0},mode:{type:String,required:!0},nameHidden:{type:Boolean,default:!1},nameNsHidden:{type:Boolean,default:!1},descriptionHidden:{type:Boolean,default:!1},extraColumns:{type:Array,default:()=>[]},nameLabel:{type:String,default:"nameNsDescription.name.label"},nameEditable:{type:Boolean,default:!1},namePlaceholder:{type:String,default:"nameNsDescription.name.placeholder"},nameDisabled:{type:Boolean,default:!1},nameRequired:{type:Boolean,default:!0},nameNormalized:{type:Boolean,default:!0},namespaced:{type:Boolean,default:!0},namespaceFilter:{type:Function,default:null},namespaceMapper:{type:Function,default:null},namespaceType:{type:String,default:w.CU},namespaceLabel:{type:String,default:"nameNsDescription.namespace.label"},namespacePlaceholder:{type:String,default:"nameNsDescription.namespace.placeholder"},namespaceDisabled:{type:Boolean,default:!1},namespaceNewAllowed:{type:Boolean,default:!1},noDefaultNamespace:{type:Boolean,default:!1},namespacesOverride:{type:Array,default:null},namespaceOptions:{type:Array,default:null},createNamespaceOverride:{type:Boolean,default:!1},descriptionLabel:{type:String,default:"nameNsDescription.description.label"},descriptionPlaceholder:{type:String,default:"nameNsDescription.description.placeholder"},descriptionDisabled:{type:Boolean,default:!1},nameKey:{type:String,default:null},namespaceKey:{type:String,default:null},descriptionKey:{type:String,default:null},forceNamespace:{type:String,default:null},showSpacer:{type:Boolean,default:!0},horizontal:{type:Boolean,default:!0},rules:{default:()=>({namespace:[],name:[],description:[]}),type:Object},componentTestid:{type:String,default:"name-ns-description"}},data(){return{createNamespace:!1}},setup(e,{emit:a}){const t=(0,n.toRef)(e.value),l=t.value.metadata,o=(0,n.ref)(null),s=(0,n.ref)(null),r=(0,n.ref)(null);(0,n.watch)(s,t=>{e.normalizeName&&(t=S(t)),e.nameKey?(0,N.hZ)(e.value,e.nameKey,t):e.value.metadata["name"]=t,a("update:value",e.value)}),e.nameKey?s.value=(0,N.Jt)(t.value,e.nameKey):s.value=l?.name||"";const c=(0,n.computed)(()=>e.mode===k.YQ),i=(0,b.Pj)(),{t:d}=(0,D.s)(i),p=(0,n.computed)(()=>i.getters.allowedNamespaces()),m=(0,n.computed)(()=>i.getters.namespaces()),u=(0,n.computed)(()=>i.getters.currentCluster),h=(0,n.computed)(()=>i.getters["currentStore"]()),v=(0,n.computed)(()=>i.getters[`${h.value}/schemaFor`](w.CU)),f=(0,n.computed)(()=>(v.value?.collectionMethods||[]).includes("POST")&&u.value?.canUpdate),y=(0,n.computed)(()=>{let a;if(e.namespacesOverride)a=e.namespacesOverride;else if(e.namespaceOptions)a=(e.namespaceOptions.map(e=>e.name)||[]).sort();else{const e=c.value?p.value:m.value;a=Object.keys(e)}const t=a.map(e=>({nameDisplay:e,id:e})).map(e.namespaceMapper||(e=>({label:e.nameDisplay,value:e.id}))),n=(0,g.Ul)(t,"label");e.forceNamespace&&n.unshift({label:e.forceNamespace,value:e.forceNamespace});const l={label:d("namespace.createNamespace"),value:"",kind:"highlighted"},o={label:"divider",disabled:!0,kind:"divider"},s=f.value||e.createNamespaceOverride?[l,o]:[];return[...s,...n]}),x=t=>{e.forceNamespace&&(t=e.forceNamespace),e.namespaced&&a("isNamespaceNew",!t||y.value&&!y.value.find(e=>e.value===t)),e.namespaceKey?(0,N.hZ)(e.value,e.namespaceKey,t):e.value.metadata.namespace=t};return e.namespaced&&(e.forceNamespace?(o.value=(0,n.toRef)(e.forceNamespace),x(o)):e.namespaceKey?o.value=(0,N.Jt)(t,e.namespaceKey):o.value=l?.namespace,o.value||e.noDefaultNamespace||(o.value=i.getters["defaultNamespace"],l&&(l.namespace=o))),e.descriptionKey?r.value=(0,N.Jt)(t.value,e.descriptionKey):r.value=l?.annotations?.[C.tC],{namespace:o,name:s,description:r,isCreate:c,options:y,updateNamespace:x}},computed:{...(0,b.i0)("cru-resource",["setCreateNamespace"]),namespaceReallyDisabled(){return!!this.forceNamespace||this.namespaceDisabled||this.mode===k.G5},nameReallyDisabled(){return this.nameDisabled||this.mode===k.G5&&!this.nameEditable},isView(){return this.mode===k.nW},showCustomize(){return this.mode===k.YQ&&this.name&&this.name.length>0},colSpan(){if(!this.horizontal)return"span-8";let e=(this.nameNsHidden?0:2)+(this.descriptionHidden?0:1)+this.extraColumns.length;e=Math.max(2,e);const a=12/e;return`span-${a}`}},watch:{namespace(e){this.updateNamespace(e),this.$emit("update:value",this.value)},description(e){this.descriptionKey?(0,N.hZ)(this.value,this.descriptionKey,e):this.value.setAnnotation(C.tC,e),this.$emit("update:value",this.value)}},mounted(){this.$nextTick(()=>{this.$refs.nameInput&&this.$refs.nameInput.focus()})},methods:{changeNameAndNamespace(e){this.name=(e.text||"").toLowerCase(),this.namespace=e.selected},cancelCreateNamespace(e){this.createNamespace=!1,this.$parent.$emit("createNamespace",!1),this.namespace=this.$store.getters["defaultNamespace"]||this.options.find(e=>!!e.value)?.value},selectNamespace(e){e&&""!==e.value?(this.createNamespace=!1,this.$store.dispatch("cru-resource/setCreateNamespace",!1),this.$emit("isNamespaceNew",!1)):(this.createNamespace=!0,this.$store.dispatch("cru-resource/setCreateNamespace",!0),this.$emit("isNamespaceNew",!0),this.$nextTick(()=>this.$refs.namespaceInput.focus()))}}},$=(t(72486),t(47433));const E=(0,$.A)(V,[["render",y],["__scopeId","data-v-135864a1"]]);var A=E,T=t(40484),_=t(16733);const O={class:"card-wrap"},L={class:"card-title","data-testid":"card-title-slot"},K={class:"card-body","data-testid":"card-body-slot"},j={key:0,class:"card-actions","data-testid":"card-actions-slot"};function M(e,a,t,l,o,s){return(0,n.openBlock)(),(0,n.createElementBlock)("div",{id:"focus-trap-card-container-element",class:(0,n.normalizeClass)(["card-container",{"highlight-border":e.showHighlightBorder,"card-sticky":e.sticky}]),"data-testid":"card"},[(0,n.createElementVNode)("div",O,[(0,n.createElementVNode)("div",L,[(0,n.renderSlot)(e.$slots,"title",{},()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.title),1)],!0)]),a[1]||(a[1]=(0,n.createElementVNode)("hr",{role:"none"},null,-1)),(0,n.createElementVNode)("div",K,[(0,n.renderSlot)(e.$slots,"body",{},()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.content),1)],!0)]),e.showActions?((0,n.openBlock)(),(0,n.createElementBlock)("div",j,[(0,n.renderSlot)(e.$slots,"actions",{},()=>[(0,n.createElementVNode)("button",{class:"btn role-primary",onClick:a[0]||(a[0]=(...a)=>e.buttonAction&&e.buttonAction(...a))},(0,n.toDisplayString)(e.buttonText),1)],!0)])):(0,n.createCommentVNode)("",!0)])],2)}var H=(0,n.defineComponent)({name:"Card",props:{title:{type:String,default:""},content:{type:String,default:""},buttonAction:{type:Function,default:()=>{}},buttonText:{type:String,default:"go"},showHighlightBorder:{type:Boolean,default:!0},showActions:{type:Boolean,default:!0},sticky:{type:Boolean,default:!1}}});t(83085);const I=(0,$.A)(H,[["render",M],["__scopeId","data-v-52307124"]]);var q=I,R={name:"CreateTemplateDialog",components:{NameNsDescription:A,AsyncButton:T.A,Banner:_.A,Card:q},props:{uitemplate:{type:Object,default:()=>({})},variableConfiguration:{type:Array,default:()=>[]},resourceConfiguration:{type:Object,default:()=>({})},doneLocation:{type:Object,default:()=>({})}},async fetch(){const e=this.$store.getters["currentStore"]("toboggan.md.template");this.model=await this.$store.dispatch(`${e}/clone`,{resource:this.uitemplate}),this.model.cleanForNew(),this.addDefaultsToNewTemplate(),"management"===e&&(this.namespaceOverride=await this.$store.dispatch(`${e}/findAll`,{type:"namespace"}))},data(){return{model:null,namespaceOverride:null}},methods:{addDefaultsToNewTemplate(){(this.model?.spec?.variables||[]).forEach(e=>{const a=this.variableConfiguration.find(a=>a.name===e.name),t=e.schema.openAPIV3Schema||{};a&&void 0!==a.value&&(t.default=a.value)}),this.model.spec.resourceDefaults=(Object.keys(this.resourceConfiguration)||[]).reduce((e,a)=>(e.push(...this.resourceConfiguration[a].map(e=>({name:a,overrides:e.overrides,variables:e.variables}))),e),[])},async save(e){this.errors=[];try{await this.model.save(),e(!0),setTimeout(()=>{this.$router.replace(this.doneLocation),this.close()},500)}catch(a){this.errors=[a],e(!1)}},close(){this.$emit("close")}}};t(1970);const z=(0,$.A)(R,[["render",c]]);var F=z},49158:function(e,a,t){"use strict";t.r(a);var n=t(40429),l=t.n(n),o=t(1214),s=t.n(o),r=s()(l());r.push([e.id,"button[data-v-135864a1]{all:unset;height:0;position:relative;top:-35px;float:right;margin-right:7px;cursor:pointer}button .align-value[data-v-135864a1]{padding-top:7px}.row.name-ns-description[data-v-135864a1]{max-height:61px}.row .namespace-select[data-v-135864a1]  .labeled-select{min-width:40%}.row .namespace-select[data-v-135864a1]  .labeled-select .v-select.inline.vs--single{padding-bottom:2px}.row.flip-direction[data-v-135864a1]{flex-direction:column}.row.flip-direction.name-ns-description[data-v-135864a1]{max-height:none}.row.flip-direction>div[data-v-135864a1]>*{margin-bottom:20px}",""]),a["default"]=r},57421:function(e,a,t){"use strict";t.r(a);var n=t(40429),l=t.n(n),o=t(1214),s=t.n(o),r=s()(l());r.push([e.id,".card-container[data-v-52307124]{border-radius:var(--border-radius);display:flex;flex-basis:40%;margin:10px;min-height:100px;padding:10px;box-shadow:0 0 20px var(--shadow)}.card-container.highlight-border[data-v-52307124]{border-left:5px solid var(--primary)}.card-container[data-v-52307124]:not(.top){align-items:top;flex-direction:row;justify-content:start}.card-container .card-wrap[data-v-52307124]{width:100%}.card-container .card-body[data-v-52307124]{color:var(--input-label);display:flex;flex-direction:column;justify-content:center}.card-container .card-actions[data-v-52307124]{align-self:end;display:flex;padding-top:20px}.card-container .card-title[data-v-52307124]{align-items:center;display:flex;width:100%}.card-container .card-title h5[data-v-52307124]{margin:0}.card-container .card-title .flex-right[data-v-52307124]{margin-left:auto}.card-container.card-sticky[data-v-52307124]{overflow:hidden}.card-container.card-sticky .card-wrap[data-v-52307124]{display:flex;flex-direction:column}.card-container.card-sticky .card-wrap .card-body[data-v-52307124]{justify-content:flex-start;overflow:auto}.card-container.card-sticky .card-wrap[data-v-52307124]>*{flex:0}.card-container.card-sticky .card-wrap .card-body[data-v-52307124]{flex:1}",""]),a["default"]=r},72486:function(e,a,t){var n=t(49158);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var l=t(74825).A;l("605edb09",n,!0,{sourceMap:!1,shadowMode:!1})},83085:function(e,a,t){var n=t(57421);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var l=t(74825).A;l("6fa4c498",n,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=ui-templates-0.1.0.umd.min.dialog.js.map